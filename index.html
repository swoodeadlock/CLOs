<script>
    async function loadGraph() {
        try {
            const response = await fetch("https://raw.githubusercontent.com/swoodeadlock/CLOs/main/CourseKG.json");
            const rawData = await response.json();

            let nodes = new vis.DataSet();
            let edges = new vis.DataSet();

            rawData.forEach(record => {
                // Extract Course (c)
                if (record.c) {
                    nodes.add({
                        id: record.c.identity,
                        label: record.c.properties.code || record.c.properties.name,
                        group: record.c.labels[0]
                    });
                }

                // Extract Learning Objective or Course (n)
                if (record.n) {
                    nodes.add({
                        id: record.n.identity,
                        label: record.n.properties.code || record.n.properties.text || record.n.properties.name,
                        group: record.n.labels[0]
                    });
                }

                // Extract Relationships (r)
                if (record.r) {
                    edges.add({
                        from: record.r.start,
                        to: record.r.end,
                        label: record.r.type
                    });
                }
            });

            console.log("Processed Nodes:", nodes);
            console.log("Processed Edges:", edges);

            const container = document.getElementById("network");
            const graphData = { nodes, edges };
            const options = { 
                nodes: { shape: "dot", size: 20 }, 
                edges: { arrows: "to", font: { align: "middle" } }
            };

            new vis.Network(container, graphData, options);
        } catch (error) {
            console.error("Error loading or processing JSON:", error);
        }
    }

    loadGraph();
</script>



